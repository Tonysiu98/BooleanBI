(*  Title:      structure.thy
    Author:     Tony Siu
*)

theory Structure
  imports Main BBI
begin

text \<open> We imported BBI formula definition in this thy file. And now we will be defining 
Structure connectives and rules\<close>

(* Substructure occureences in a structure X are classified as either positive or negative*)
datatype sign = positive | negative

section "Structure Definition"

text \<open> We define structures in terms of Antecedent and consequent. This is done through mutual recursion
dataype definition. As BBI is CL + LM, our connectives are based on DL of CL & LM\<close>

datatype Antecedent_Structure =
formula BBI_form|
AddNil       ("\<emptyset>") |
Sharp Consequent_Structure    ("\<sharp> _" 100)|
SemiColon   Antecedent_Structure Antecedent_Structure (infix ";" 101)|
MultNil     ("\<oslash>")|
Comma Antecedent_Structure Antecedent_Structure (infix "," 101)
and
Consequent_Structure = 
formula BBI_form |
AddNil       ("\<emptyset>")|
Sharp Antecedent_Structure  ("\<sharp> _" 100)|
SemiColon Consequent_Structure Consequent_Structure (infix ";" 101)|
DotArrow Antecedent_Structure Consequent_Structure  (infix "\<comment>\<circ>" 101)

text \<open> With basic definition of Antecedent Structure and Consequent Structure, we now define 
formula meaning in Structures\<close>

primrec 
  \<psi> :: "Antecedent_Structure \<Rightarrow> BBI_form"  and 
  \<gamma> :: "Consequent_Structure \<Rightarrow> BBI_form"
  where
"\<psi> (formula F)  = F"|
"\<psi> AddNil = \<top>\<^sub>B"|
"\<psi> (Sharp X) =\<not>\<^sub>B \<gamma> X "|
"\<psi> (SemiColon X X) = (\<psi> X) \<and>\<^sub>B (\<psi> X)"|
"\<psi> MultNil = \<top>\<^sup>*\<^sub>B "|
"\<psi> (Comma X Y) = (\<psi> X) *\<^sub>B (\<psi> Y) "|
"\<gamma> (formula F) = F"|
"\<gamma> AddNill = \<bottom>\<^sub>B "|
"\<gamma> (Sharp X) =  \<not>\<^sub>B \<psi> X"|
"\<gamma> (SemiColon Y Y) = \<gamma> Y \<or>\<^sub>B \<gamma> Y"|
"\<gamma> (DotArrow X Y) = \<psi> X \<rightarrow>\<^emph>\<^sub>B \<gamma> Y"

 
end